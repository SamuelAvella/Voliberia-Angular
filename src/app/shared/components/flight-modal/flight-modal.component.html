<ion-header>
  <ion-toolbar color="primary">
    <ion-title class="ion-text-center">
      {{ flight ? ('FLIGHT.EDIT' | translate) : ('FLIGHT.NEW' | translate) }}
    </ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()" color="light">
        <ion-icon slot="icon-only" name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="bg-white font-inter">
  <div class="w-full max-w-xl mx-auto px-6 py-4">
    <form [formGroup]="formGroup" (ngSubmit)="onSubmit()" class="space-y-4">

      <!-- ORIGIN -->
      <div>
        <label class="text-sm font-semibold text-gray-700">{{ 'FLIGHT.ORIGIN' | translate }}</label>
        <ion-input
          formControlName="origin"
          placeholder="{{ 'FLIGHT.ORIGIN_INSERT' | translate }}"
          class="h-[40px] w-full mt-1 px-3 border border-gray-300 rounded-md text-sm text-black bg-white focus:outline-none shadow-sm">
        </ion-input>
      </div>

      <!-- DESTINATION -->
      <div>
        <label class="text-sm font-semibold text-gray-700">{{ 'FLIGHT.DESTINATION' | translate }}</label>
        <ion-input
          formControlName="destination"
          placeholder="{{ 'FLIGHT.DESTINATION_INSERT' | translate }}"
          class="h-[40px] w-full mt-1 px-3 border border-gray-300 rounded-md text-sm text-black bg-white focus:outline-none shadow-sm">
        </ion-input>
      </div>

      <!-- DEPARTURE -->
      <div class="relative z-[9999]" #departureWrapper>
        <label class="text-sm font-medium text-gray-700">{{ 'FLIGHT.DEPARTURE' | translate }}</label>
        <div
          class="h-[40px] mt-1 border rounded-md px-3 text-sm flex justify-between items-center cursor-pointer bg-white text-black border-gray-300 hover:shadow-sm"
          (click)="openDateSelector('departure', $event)">
          <div class="flex items-center gap-2">
            <ion-icon name="calendar-outline" class="text-gray-400"></ion-icon>
            <span *ngIf="departureDate && departureTime; else depPlaceholder">
              {{ departureDate | date: 'mediumDate' }} - {{ departureTime }}
            </span>
            <ng-template #depPlaceholder>
              {{ 'FLIGHT.DEPARTURE' | translate }}
            </ng-template>
          </div>
          <ion-icon *ngIf="departureDate" name="close-outline" (click)="clearDate('departure'); $event.stopPropagation()" class="text-gray-400 hover:text-gray-700 cursor-pointer"></ion-icon>
        </div>

        <div *ngIf="toggleDateSelector === 'departure'" class="absolute z-[9999] mt-2 w-full bg-white border border-gray-300 rounded-md shadow-md p-2" (click)="$event.stopPropagation()">
          <ion-datetime
            presentation="date"
            [min]="minDepartureDate"
            (ionChange)="onDatePartSelected($event, 'departure', $event)">
          </ion-datetime>
        </div>

        <div *ngIf="toggleTimeSelector === 'departure'" class="absolute z-[9999] mt-2 w-full bg-white border border-gray-300 rounded-md shadow-md p-2" (click)="$event.stopPropagation()">
          <ion-datetime
            presentation="time"
            (ionChange)="onTimePartSelected($event, 'departure')">
          </ion-datetime>
        </div>
      </div>

        <!-- ARRIVAL -->
        <div class="relative z-[9999]" #arrivalWrapper>
          <label class="text-sm font-medium text-gray-700">{{ 'FLIGHT.ARRIVAL' | translate }}</label>
          <div
            class="h-[40px] mt-1 border rounded-md px-3 text-sm flex justify-between items-center cursor-pointer bg-white text-black border-gray-300 hover:shadow-sm"
            (click)="openDateSelector('arrival', $event)">
            <div class="flex items-center gap-2">
              <ion-icon name="calendar-outline" class="text-gray-400"></ion-icon>
              <span *ngIf="arrivalDate && arrivalTime; else arrPlaceholder">
                {{ arrivalDate | date: 'mediumDate' }} - {{ arrivalTime }}
              </span>
              <ng-template #arrPlaceholder>
                {{ 'FLIGHT.ARRIVAL' | translate }}
              </ng-template>
            </div>
            <ion-icon *ngIf="arrivalDate" name="close-outline" (click)="clearDate('arrival'); $event.stopPropagation()" class="text-gray-400 hover:text-gray-700 cursor-pointer"></ion-icon>
          </div>

          <div *ngIf="toggleDateSelector === 'arrival'" class="absolute z-[9999] mt-2 w-full bg-white border border-gray-300 rounded-md shadow-md p-2" (click)="$event.stopPropagation()">
            <ion-datetime
              presentation="date"
              [min]="minDepartureDate"
              (ionChange)="onDatePartSelected($event, 'arrival', $event)">
            </ion-datetime>
          </div>

          <div *ngIf="toggleTimeSelector === 'arrival'" class="absolute z-[9999] mt-2 w-full bg-white border border-gray-300 rounded-md shadow-md p-2" (click)="$event.stopPropagation()">
            <ion-datetime
              presentation="time"
              (ionChange)="onTimePartSelected($event, 'arrival')">
            </ion-datetime>
          </div>
        </div>

      <!-- PRICE -->
      <div>
        <label class="text-sm font-semibold text-gray-700">{{ 'FLIGHT.PRICE' | translate }}</label>
        <ion-input
          type="number"
          formControlName="seatPrice"
          placeholder="Enter Seat Price"
          class="h-[40px] w-full mt-1 px-3 border border-gray-300 rounded-md text-sm text-black bg-white focus:outline-none shadow-sm">
        </ion-input>
      </div>

      <div>
  <label class="text-sm font-semibold text-gray-700">{{ 'FLIGHT.ORIGIN' | translate }}</label>
  <div class="relative mt-1">
    <ion-icon name="airplane-outline"
      class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-lg z-10"></ion-icon>

    <ion-input
      style="--padding-start: 40px;"
      formControlName="origin"
      placeholder="{{ 'FLIGHT.ORIGIN_INSERT' | translate }}"
      class="h-[40px] w-full px-3 py-2 border border-gray-300 rounded-md text-sm text-black bg-white focus:border-blue-500 focus:outline-none shadow-sm">
    </ion-input>
  </div>
</div>


      <!-- SUBMIT -->
      <div>
        <ion-button
          type="submit"
          expand="block"
          color="success"
          [disabled]="!formGroup.valid"
          class="h-[40px] text-white font-medium rounded-md">
          {{ flight ? ('FLIGHT.SAVE' | translate) : ('FLIGHT.CREATE' | translate) }}
        </ion-button>
      </div>

    </form>
  </div>
</ion-content>
